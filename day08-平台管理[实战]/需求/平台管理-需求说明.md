## 平台管理-需求说明



要求：

- 每个组长要分配任务，共同完成这些需求
- 需要创建一个开源项目（每个组创建一个），其他组员共同提交到这个仓库里，最后合并为一个完整的项目
  - 组长创建一个git项目
  - 基础代码是day07完成后的代码
  - 每个组员需要克隆到本地
  - 每个组员创建一个分支去开发
  - 合并为一个完整的项目

28号晚上答辩

- 展示完成的项目功能
- 给同学在讲台上，人选：最好是不爱说话或不敢说话的人

### 0)平台管理前端

查看资料中的admin-web文件夹，使用nginx部署

nginx中的配置为：

```javascript
upstream  heima-admin-gateway{
    server localhost:6001;
}

server {
	listen 8803;
	location / {
		root D:/workspace/admin-web/;
		index index.html;
	}
	
	location ~/service_6001/(.*) {
		proxy_pass http://heima-admin-gateway/$1;
		proxy_set_header HOST $host;  # 不改变源请求头的值
		proxy_pass_request_body on;  #开启获取请求体
		proxy_pass_request_headers on;  #开启获取请求头
		proxy_set_header X-Real-IP $remote_addr;   # 记录真实发出请求的客户端IP
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  #记录代理信息
	}
}
```

### 1)登录及网关

#### 1.1)登录

平台管理的表，请查看资料中导入到数据库中 leadnews_admin.sql

![image-20210725225604300](平台管理-需求说明.assets\image-20210725225604300.png)

- 用户根据用户名和密码登录
- 密码需要手动加盐验证
- 需要返回用户的token和用户信息

#### 1.2)网关

平台管理端，是作为平台管理员使用的后台服务，所有后台的请求，都应该经过网关访问，需要创建平台管理的网关，并使用nacos配置

- 需要校验jwt
- 路由其他微服务

### 2)频道管理

#### 2.1)新增

![image-20210725225940936](平台管理-需求说明.assets\image-20210725225940936.png)

- 前台输入内容进行频道的保存
- 频道名词不能重复

#### 2.2)查询列表

![image-20210725230126215](平台管理-需求说明.assets\image-20210725230126215.png)

- 查询需要按照创建时间倒序查询
- 按照频道名称模糊查询
- 可以按照状态进行精确查找（1：启用   true           0：禁用   false）
- 分页查询

#### 2.3)修改

![image-20210725230556844](平台管理-需求说明.assets\image-20210725230556844.png)

- 点击编辑后可以修改频道
- 如果频道被引用则不能禁用

#### 2.4)删除

只有禁用的频道才能删除

### 3)敏感词管理

#### 3.1)新增

![image-20210725230741203](平台管理-需求说明.assets\image-20210725230741203.png)

- 弹出的输入框，输入敏感词可直接保存
- 已存在的敏感词则不能保存

#### 3.2)查询列表

![image-20210725230914763](平台管理-需求说明.assets\image-20210725230914763.png)

- 查询需要按照创建时间倒序查询
- 按照敏感词名称模糊查询
- 分页查询

#### 3.3)修改

![image-20210725230942502](平台管理-需求说明.assets\image-20210725230942502.png)



#### 3.4)删除

直接删除即可

### 4)用户认证审核

- 在app端的个人中心用户可以实名认证，需要材料为：姓名、身份证号、身份证正面照、身份证反面照、手持照片、活体照片（通过**微笑、眨眼、张嘴、摇头、点头**等组合动作，确保操作的为真实活体人脸。），当用户提交审核后就到了后端让运营管理人员进行审核
- 平台运营端查看用户认证信息，进行审核，其中审核包括了用户身份审核，需要对接公安系统校验身份证信息
- 用户通过审核后需要开通自媒体账号（该账号的用户名和密码与app一致）

#### 4.1)分页查询认证列表

![image-20210725231452092](平台管理-需求说明.assets\image-20210725231452092.png)

- 可根据审核状态条件查询
- 需要分页查询

#### 4.2)审核

​		人工审核
​			拒绝
​			审核成功

### 5)文章人工审核

自媒体文章如果没有自动审核成功，而是到了人工审核（自媒体文章状态为3），需要在admin端人工处理文章的审核

- 平台管理员可以查看待人工审核的文章信息，如果存在违规内容则驳回（状态改为2，文章审核失败）
- 平台管理员可以查看待人工审核的文章信息，如果不存在违规，则需要创建app端的文章信息，并更新自媒体文章的状态

也可以通过点击**查看**按钮，查看文章详细信息，查看详情后可以根据内容判断是否需要通过审核

#### 5.1)文章列表查询

![image-20210725233328453](平台管理-需求说明.assets\image-20210725233328453.png)

- 分页查询自媒体文章
- 可以按照标题模糊查询
- 可以按照审核状态进行精确检索
- 文章查询按照创建时间倒序查询
- 注意：需要展示作者名称

#### 5.2)查询文章详情

![image-20210725233521821](平台管理-需求说明.assets\image-20210725233521821.png)

- 可以查看文章详细内容
- 注意：需要展示作者名称

#### 5.3)人工审核

##### 5.3.1) 拒绝

![image-20210726013458078](平台管理-需求说明.assets\image-20210726013458078.png)

拒绝以后需要给出原因，并修改文章的状态为2



##### 5.3.2)审核成功

![image-20210726013527654](平台管理-需求说明.assets\image-20210726013527654.png)

需要创建app端的文章信息，并更新自媒体文章的状态