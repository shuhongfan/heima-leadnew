{"version":3,"sources":["webpack:///src/views/material/index.vue","webpack:///./src/views/material/index.vue?d728","webpack:///./src/views/material/index.vue","webpack:///src/components/Upload/upload.vue","webpack:///./src/components/Upload/upload.vue?88dd","webpack:///./src/components/Upload/upload.vue"],"names":["material","name","mixins","components","Pagination","pagination","Upload","upload","EmptyData","empty_data","data","total","listQuery","page","size","isCollection","imgChange","showPicDialog","list","created","this","getList","methods","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","result","wrap","_context","prev","next","Object","publish","sent","stop","collectOrCancel","img","_this2","_callee2","isCollected","_context2","id","code","$forceUpdate","$message","type","message","errorMessage","delImg","_this3","_callee3","_ref","_context3","showDeleteConfirm","t0","console","log","uploadSuccess","closeModal","handleSwitchChange","views_material","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","width","active-value","inactive-value","active-text","inactive-text","active-color","inactive-color","on","change","model","value","callback","$$v","$set","expression","_v","_s","click","$event","aria-hidden","xlink:href","_l","key","body-style","padding","shadow","class","collection","src","url","slot","__webpack_require__","_e","directives","rawName","limit","update:page","update:limit","center","close-on-click-modal","close-on-press-escape","visible","show-close","before-close","update:visible","dialogVisible","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__","props","uploadImgUrl","file","watch","newVal","oldVal","clearFiles","handleChange","fileList","handleExceed","files","$refs","handleStart","handleRemove","fnUpload","isJPG","isLt2M","fd","raw","error","abrupt","FormData","append","$emit","error_message","Upload_upload","ref","action","accept","show-file-list","auto-upload","on-change","on-remove","on-exceed","staticStyle","margin-top"],"mappings":"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","file":"static/js/7.9872f3144fd3075d8c6f.js","sourcesContent":["<template>\n  <div class=\"bgc\">\n    <div class=\"filter\">\n      <div class=\"filter-container\">\n        <el-switch\n          v-model=\"listQuery.isCollection\"\n          :width=\"138\"\n          :active-value=\"1\"\n          :inactive-value=\"0\"\n          active-text=\"收藏\"\n          inactive-text=\"全部\"\n          active-color=\"#F3F4F7\"\n          inactive-color=\"#F3F4F7\"\n          @change=\"handleSwitchChange\"\n        ></el-switch>\n      </div>\n      <div>\n        <span class=\"total\">已上传{{ total }}张图片</span>\n        <el-button type=\"success\" class=\"el-button--has-icon\" @click=\"showPicDialog = true\">\n          <svg class=\"icon svg-icon\" aria-hidden=\"true\">\n            <use xlink:href=\"#iconicon_btn_tjsh\" />\n          </svg>\n          上传图片\n        </el-button>\n      </div>\n    </div>\n    <div v-if=\"list.length\" class=\"content-card\">\n      <el-card v-for=\"img in list\" :key=\"img.id\" :body-style=\"{ padding: '0px' }\" shadow=\"hover\">\n        <el-image :src=\"img.url\" :class=\"{'collection': listQuery.isCollection == 1}\">\n          <div slot=\"placeholder\" class=\"image-slot\">\n            <img src=\"@/assets/news/pic_loading@2x.png\" />\n          </div>\n          <div slot=\"error\" class=\"image-slot\">\n            <img src=\"@/assets/news/pic_fail.png\" />\n          </div>\n        </el-image>\n        <div v-if=\"listQuery.isCollection == 0\" class=\"operate\">\n          <div class=\"item\" @click=\"collectOrCancel(img)\">\n            <svg class=\"icon svg-icon\" aria-hidden=\"true\">\n              <use :xlink:href=\"img.isCollection ? '#iconbtn_collect_sel' : '#iconbtn_collect'\" />\n            </svg>\n            {{ img.isCollection ? '已收藏' : '收藏' }}\n          </div>\n          <div class=\"item\" @click=\"delImg(img)\">\n            <svg class=\"icon svg-icon\" aria-hidden=\"true\">\n              <use xlink:href=\"#iconbtn_del\" />\n            </svg>删除\n          </div>\n        </div>\n      </el-card>\n    </div>\n    <empty-data v-else />\n\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.size\" @pagination=\"getList\" />\n\n    <el-dialog\n      width=\"849px\"\n      center\n      :close-on-click-modal=\"false\"\n      :close-on-press-escape=\"false\"\n      :visible.sync=\"showPicDialog\"\n      :show-close=\"false\"\n      :before-close=\"closeModal\"\n    >\n      <upload :dialogVisible=\"showPicDialog\" @uploadSuccess=\"uploadSuccess\" />\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"warning\" class=\"el-button--no-icon\" @click=\"closeModal\">关闭</el-button>\n        <el-button type=\"success\" class=\"el-button--no-icon\" @click=\"closeModal\">确定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport myMixin from '@/utils/mixins'\nimport Pagination from '@/components/pagination'\nimport EmptyData from '@/components/empty-data'\nimport Upload from '@/components/Upload/upload.vue'\nimport { getAllImgData, delImg, collectOrCancel } from '@/api/publish'\n\nexport default {\n  name: 'MaterialList',\n  mixins: [myMixin],\n  components: {\n    Pagination,\n    Upload,\n    EmptyData\n  },\n  data () {\n    return {\n      total: 0,\n      listQuery: {\n        page: 1,\n        size: 20,\n        isCollection: 0\n      },\n      imgChange: false, // 是否上传过图片导致图片数据变化 此状态用来控制是否在关闭后要进行重新加载\n      showPicDialog: false,\n      list: []// 存储图片的数据 同时作为收藏数据和全部数据的引用\n    }\n  },\n  created () {\n    this.getList()\n  },\n  methods: {\n    async getList () {\n      const result = await getAllImgData(this.listQuery)\n      this.list = result.data\n      this.total = result.total\n    },\n    // 取消或者收藏图片\n    async collectOrCancel (img) {\n      let isCollected = img.isCollection\n      if (isCollected === 1) { isCollected = 0 } else { isCollected = 1 }\n      // 取相反状态\n      const result = await collectOrCancel(img.id, { isCollected: isCollected })\n      if (result.code === 200) {\n        img.isCollection = isCollected // 取相反状态\n        this.$forceUpdate() // 强制更新\n        this.$message({ type: 'success', message: '操作成功' })\n      } else {\n        this.$message({ type: 'error', message: result.errorMessage })\n      }\n    },\n    // 删除图片\n    async delImg (img) {\n      try {\n        await this.showDeleteConfirm('素材')\n\n        const { code, errorMessage } = await delImg(img.id)\n        if (code === 200) {\n          this.$message({ type: 'success', message: '删除成功' })\n          this.getList()\n        } else {\n          this.$message({ type: 'error', message: errorMessage })\n        }\n      } catch (err) {\n        // this.$message({ type: 'info', message: '已取消删除' })\n        console.log('err: ' + err)\n      }\n    },\n    uploadSuccess () {\n      this.imgChange = true\n    },\n    closeModal () {\n      if (this.imgChange) {\n        this.getList()\n        this.imgChange = false\n      }\n      this.showPicDialog = false\n    },\n    handleSwitchChange () {\n      this.listQuery.page = 1\n      this.getList()\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n@import '@/scss/element-variables.scss';\n\n.filter {\n  height: 96px;\n}\n\n/deep/ .el-switch {\n  height: auto;\n}\n\n/deep/ .el-switch__label {\n  position: absolute;\n  color: $--color-text-secondary;\n}\n\n/deep/ .el-switch__label.is-active {\n  color: $--color-text-primary;\n  font-weight: 600;\n}\n\n/deep/ .el-switch__label--left {\n  left: 0;\n  margin-left: 22px;\n  z-index: 9999;\n}\n\n/deep/ .el-switch__label--right {\n  right: 0;\n  margin-right: 23px;\n}\n\n/deep/ .el-switch__core {\n  height: 40px;\n  border-radius: 4px;\n}\n\n/deep/ .el-switch__core:after {\n  width: 63px;\n  height: 32px;\n  top: 3px;\n  left: 3px;\n  box-shadow: 0px 1px 4px 0px rgba(0, 0, 0, 0.06);\n  border-radius: 4px;\n}\n\n/deep/ .el-switch.is-checked .el-switch__core::after {\n  margin-left: 65px;\n  left: 3px;\n}\n\n.total {\n  margin-right: 16px;\n  color: $--color-text-secondary;\n}\n\n.content-card {\n  display: flex;\n  padding-left: 6px;\n  padding-bottom: 30px;\n  flex-wrap: wrap;\n\n  .el-card {\n    position: relative;\n    width: 186px;\n    height: 183px;\n    margin-top: 30px;\n    margin-left: 24px;\n    border-radius: 8px;\n    border: 1px solid $--background-color-base;\n\n    /deep/ .el-image__inner,\n    .image-slot img {\n      display: block;\n      width: 100%;\n      height: 124px;\n      object-fit: cover;\n    }\n\n    .collection {\n      /deep/ .el-image__inner,\n      .image-slot img {\n        height: 183px;\n      }\n    }\n\n    .operate {\n      display: flex;\n      height: 57px;\n      justify-content: space-around;\n      align-items: center;\n\n      .item {\n        display: flex;\n        align-items: center;\n        font-size: 12px;\n        cursor: pointer;\n\n        .icon {\n          width: 30px;\n          height: 30px;\n        }\n      }\n    }\n  }\n\n  .el-card.is-always-shadow,\n  .el-card.is-hover-shadow:focus,\n  .el-card.is-hover-shadow:hover {\n    -webkit-box-shadow: 0px 2px 8px 4px rgba(51, 53, 58, 0.07);\n    box-shadow: 0px 2px 8px 4px rgba(51, 53, 58, 0.07);\n  }\n}\n\n.el-pagination {\n  border-top: 2px solid #EBEEF5;\n}\n\n/deep/ .el-dialog__footer {\n  border-top: 2px solid #EBEEF5;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/material/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"bgc\"},[_c('div',{staticClass:\"filter\"},[_c('div',{staticClass:\"filter-container\"},[_c('el-switch',{attrs:{\"width\":138,\"active-value\":1,\"inactive-value\":0,\"active-text\":\"收藏\",\"inactive-text\":\"全部\",\"active-color\":\"#F3F4F7\",\"inactive-color\":\"#F3F4F7\"},on:{\"change\":_vm.handleSwitchChange},model:{value:(_vm.listQuery.isCollection),callback:function ($$v) {_vm.$set(_vm.listQuery, \"isCollection\", $$v)},expression:\"listQuery.isCollection\"}})],1),_vm._v(\" \"),_c('div',[_c('span',{staticClass:\"total\"},[_vm._v(\"已上传\"+_vm._s(_vm.total)+\"张图片\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"el-button--has-icon\",attrs:{\"type\":\"success\"},on:{\"click\":function($event){_vm.showPicDialog = true}}},[_c('svg',{staticClass:\"icon svg-icon\",attrs:{\"aria-hidden\":\"true\"}},[_c('use',{attrs:{\"xlink:href\":\"#iconicon_btn_tjsh\"}})]),_vm._v(\"\\n        上传图片\\n      \")])],1)]),_vm._v(\" \"),(_vm.list.length)?_c('div',{staticClass:\"content-card\"},_vm._l((_vm.list),function(img){return _c('el-card',{key:img.id,attrs:{\"body-style\":{ padding: '0px' },\"shadow\":\"hover\"}},[_c('el-image',{class:{'collection': _vm.listQuery.isCollection == 1},attrs:{\"src\":img.url}},[_c('div',{staticClass:\"image-slot\",attrs:{\"slot\":\"placeholder\"},slot:\"placeholder\"},[_c('img',{attrs:{\"src\":require(\"@/assets/news/pic_loading@2x.png\")}})]),_vm._v(\" \"),_c('div',{staticClass:\"image-slot\",attrs:{\"slot\":\"error\"},slot:\"error\"},[_c('img',{attrs:{\"src\":require(\"@/assets/news/pic_fail.png\")}})])]),_vm._v(\" \"),(_vm.listQuery.isCollection == 0)?_c('div',{staticClass:\"operate\"},[_c('div',{staticClass:\"item\",on:{\"click\":function($event){return _vm.collectOrCancel(img)}}},[_c('svg',{staticClass:\"icon svg-icon\",attrs:{\"aria-hidden\":\"true\"}},[_c('use',{attrs:{\"xlink:href\":img.isCollection ? '#iconbtn_collect_sel' : '#iconbtn_collect'}})]),_vm._v(\"\\n          \"+_vm._s(img.isCollection ? '已收藏' : '收藏')+\"\\n        \")]),_vm._v(\" \"),_c('div',{staticClass:\"item\",on:{\"click\":function($event){return _vm.delImg(img)}}},[_c('svg',{staticClass:\"icon svg-icon\",attrs:{\"aria-hidden\":\"true\"}},[_c('use',{attrs:{\"xlink:href\":\"#iconbtn_del\"}})]),_vm._v(\"删除\\n        \")])]):_vm._e()],1)}),1):_c('empty-data'),_vm._v(\" \"),_c('pagination',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.total>0),expression:\"total>0\"}],attrs:{\"total\":_vm.total,\"page\":_vm.listQuery.page,\"limit\":_vm.listQuery.size},on:{\"update:page\":function($event){return _vm.$set(_vm.listQuery, \"page\", $event)},\"update:limit\":function($event){return _vm.$set(_vm.listQuery, \"size\", $event)},\"pagination\":_vm.getList}}),_vm._v(\" \"),_c('el-dialog',{attrs:{\"width\":\"849px\",\"center\":\"\",\"close-on-click-modal\":false,\"close-on-press-escape\":false,\"visible\":_vm.showPicDialog,\"show-close\":false,\"before-close\":_vm.closeModal},on:{\"update:visible\":function($event){_vm.showPicDialog=$event}}},[_c('upload',{attrs:{\"dialogVisible\":_vm.showPicDialog},on:{\"uploadSuccess\":_vm.uploadSuccess}}),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{staticClass:\"el-button--no-icon\",attrs:{\"type\":\"warning\"},on:{\"click\":_vm.closeModal}},[_vm._v(\"关闭\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"el-button--no-icon\",attrs:{\"type\":\"success\"},on:{\"click\":_vm.closeModal}},[_vm._v(\"确定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-310e38fb\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/material/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-310e38fb\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-310e38fb\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-310e38fb\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/material/index.vue\n// module id = null\n// module chunks = ","<template>\n  <div>\n    <el-upload\n      ref=\"upload\"\n      class=\"uploader\"\n      action\n      accept=\".jpg,.png\"\n      :show-file-list=\"true\"\n      :auto-upload=\"false\"\n      :limit=\"1\"\n      :on-change=\"handleChange\"\n      :on-remove=\"handleRemove\"\n      :on-exceed=\"handleExceed\"\n      >\n      <svg v-if=\"!uploadImgUrl\" class=\"icon svg-icon\" aria-hidden=\"true\">\n        <use xlink:href=\"#icon_btn_addpic\" />\n      </svg>\n      <span v-if=\"!uploadImgUrl\">选择图片</span>\n      <img v-if=\"uploadImgUrl\" :src=\"uploadImgUrl\" class=\"avatar\">\n      <div\n        slot=\"tip\"\n        class=\"el-upload__tip\">\n        支持扩展名：jpg、png，文件不得大于2MB\n      </div>\n    </el-upload>\n    <el-button type=\"success\" class=\"el-button--has-icon\" @click=\"fnUpload\" style=\"margin-top: 30px;\">\n      <svg class=\"icon svg-icon\" aria-hidden=\"true\">\n        <use xlink:href=\"#iconicon_btn_tjsh\" />\n      </svg>\n      开始上传\n    </el-button>\n  </div>\n</template>\n\n<script>\nimport { uploadImg } from '@/api/publish'\n\nexport default {\n  name: 'upload',\n  props: ['dialogVisible'],\n  data () {\n    return {\n      uploadImgUrl: '',\n      file: {}\n    }\n  },\n  watch: {\n    dialogVisible: function (newVal, oldVal) {\n      // 关闭对话框前，清空上传文件\n      if (!newVal) {\n        this.clearFiles()\n      }\n    }\n  },\n  methods: {\n    handleChange (file, fileList) {\n      this.file = file\n    },\n    handleExceed (files, fileList) {\n      this.$set(fileList[0], 'raw', files[0])\n      this.$set(fileList[0], 'name', files[0].name)\n      this.$refs.upload.clearFiles() // 清除文件\n      this.$refs.upload.handleStart(files[0]) // 选择文件后的赋值方法\n    },\n    handleRemove (file, fileList) {\n      this.clearFiles()\n    },\n    // 上传图片\n    async fnUpload () {\n      const file = this.file.raw\n      if (!file) {\n        this.$message.error('请选择图片')\n        return\n      }\n\n      const isJPG =\n      file.type === 'image/jpeg' ||\n      file.type === 'image/png'\n      const isLt2M = file.size / 1024 / 1024 < 2\n\n      if (!isJPG) {\n        this.$message.error('上传图片只能是jpg/png格式')\n        return\n      }\n      if (!isLt2M) {\n        this.$message.error('上传图片大小不能超过2MB')\n        return\n      }\n\n      const fd = new FormData()\n      fd.append('multipartFile', file, file.name)\n\n      const result = await uploadImg(fd)\n      if (result.code === 200) {\n        this.$message({ message: '上传成功', type: 'success' })\n        this.uploadImgUrl = result.data.url\n        this.$emit('uploadSuccess', this.uploadImgUrl)\n        this.clearFiles()\n      } else {\n        this.$message({ message: result.error_message, type: 'error' })\n      }\n    },\n    clearFiles () {\n      // TODO: 最好用form resetFields\n      this.$refs.upload.clearFiles()\n      this.uploadImgUrl = ''\n      this.file = {}\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/scss/element-variables.scss';\n\n// TODO: 线上样式和本地不一致，可能是webpack配置导致\n.el-dialog--center .el-dialog__body {\n  padding: 40px 49px 19px 49px;\n}\n\n.uploader {\n  text-align: left;\n\n  .el-upload {\n    position: relative;\n    width: 225px;\n    height: 150px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    border: 2px dashed $--border-color-base;\n    color: $--color-text-primary;\n\n    .icon {\n      width: 40px;\n      height: 40px;\n    }\n\n    .avatar {\n      width: 225px;\n      height: 150px;\n      object-fit: cover;\n    }\n  }\n\n  .el-upload:hover {\n    color: $--color-primary;\n  }\n\n  .el-upload-list__item {\n    height: 40px;\n    line-height: 40px;\n  }\n\n  .el-upload-list__item:hover {\n    background-color: #F0F0F0;\n  }\n\n  .el-upload-list__item-name {\n    margin-left: 14px;\n    color: $--color-text-secondary;\n  }\n\n  .el-upload-list__item:first-child {\n    margin-top: 20px;\n  }\n\n  .el-upload-list__item .el-icon-close {\n    top: 13px;\n    right: 13px;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Upload/upload.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-upload',{ref:\"upload\",staticClass:\"uploader\",attrs:{\"action\":\"\",\"accept\":\".jpg,.png\",\"show-file-list\":true,\"auto-upload\":false,\"limit\":1,\"on-change\":_vm.handleChange,\"on-remove\":_vm.handleRemove,\"on-exceed\":_vm.handleExceed}},[(!_vm.uploadImgUrl)?_c('svg',{staticClass:\"icon svg-icon\",attrs:{\"aria-hidden\":\"true\"}},[_c('use',{attrs:{\"xlink:href\":\"#icon_btn_addpic\"}})]):_vm._e(),_vm._v(\" \"),(!_vm.uploadImgUrl)?_c('span',[_vm._v(\"选择图片\")]):_vm._e(),_vm._v(\" \"),(_vm.uploadImgUrl)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.uploadImgUrl}}):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"\\n      支持扩展名：jpg、png，文件不得大于2MB\\n    \")])]),_vm._v(\" \"),_c('el-button',{staticClass:\"el-button--has-icon\",staticStyle:{\"margin-top\":\"30px\"},attrs:{\"type\":\"success\"},on:{\"click\":_vm.fnUpload}},[_c('svg',{staticClass:\"icon svg-icon\",attrs:{\"aria-hidden\":\"true\"}},[_c('use',{attrs:{\"xlink:href\":\"#iconicon_btn_tjsh\"}})]),_vm._v(\"\\n    开始上传\\n  \")])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6b1dbc3c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Upload/upload.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6b1dbc3c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./upload.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./upload.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./upload.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6b1dbc3c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./upload.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Upload/upload.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}